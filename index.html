<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>DeepBits</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-color: #f7f9fc;
      --text-color: #333;
      --link-color: #0077cc;
      --heading-color: #222;
      --code-bg: #eee;
    }

    body.dark {
      --bg-color: #121212;
      --text-color: #eee;
      --link-color: #4ea3ff;
      --heading-color: #fff;
      --code-bg: #1e1e1e;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      max-width: 800px;
      margin: auto;
      padding: 2rem;
      transition: background 0.3s, color 0.3s;
    }

    body.rtl {
      direction: rtl;
      text-align: right;
    }
    body.rtl .post-list a {
      text-align: right;
    }

    h1 {
      color: var(--heading-color);
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    h2 {
      color: var(--heading-color);
    }

    .blog-subtitle {
      font-size: 1rem;
      color: var(--text-color);
      margin-bottom: 1rem;
      font-style: italic;
    }

    .brand-description {
      font-size: 0.95rem;
      color: var(--text-color);
      margin-bottom: 2rem;
      line-height: 1.5;
    }

    .post-list a {
      display: block;
      margin: 0.8rem 0 0.2rem;
      font-size: 1.1rem;
      color: var(--link-color);
      text-decoration: none;
    }

    .post-list a:hover {
      text-decoration: underline;
    }

    #back-button {
      display: inline-block;
      margin: 1rem 0;
      color: var(--link-color);
      text-decoration: none;
    }

    pre {
      background: var(--code-bg);
      padding: 1rem;
      overflow-x: auto;
      border-radius: 8px;
    }

    .tag {
      display: inline-block;
      background: #ccc;
      padding: 2px 8px;
      margin: 0 5px;
      font-size: 0.85rem;
      border-radius: 4px;
      color: #333;
    }

    body.dark .tag {
      background: #333;
      color: #ccc;
    }

    .post-meta {
      font-size: 0.9rem;
      color: #666;
      margin-bottom: 1rem;
    }

    .theme-toggle {
      position: fixed;
      top: 1rem;
      right: 1rem;
      background: none;
      border: 1px solid var(--text-color);
      color: var(--text-color);
      padding: 0.4rem 0.8rem;
      font-size: 0.9rem;
      border-radius: 6px;
      cursor: pointer;
      margin-left: 0.5rem;
      z-index: 1000;
    }

    .lang-toggle {
      position: fixed;
      top: 1rem;
      right: 5rem;
      background: none;
      border: 1px solid var(--text-color);
      color: var(--text-color);
      padding: 0.4rem 0.8rem;
      font-size: 0.9rem;
      border-radius: 6px;
      cursor: pointer;
      z-index: 1000;
    }
  </style>
</head>
<body>
  <button class="theme-toggle" onclick="toggleTheme()">üåó</button>
  <button class="lang-toggle" onclick="toggleLanguage()">FA</button>
  
  <h1 id="blog-title"></h1>
  <div class="blog-subtitle"></div>
  <div class="brand-description"></div>

  <div id="content">Loading...</div>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    const posts = [
      {
        date: '2025-07-01',
        tags: ['intro', 'welcome'],
        en: { title: 'Hello World', file: '2-en.md' },
        fa: { title: 'ÿ≥ŸÑÿßŸÖ ÿØŸÜ€åÿß', file: '2-fa.md' }
      },
      {
        date: '2025-07-10',
        tags: ['dev', 'update'],
        en: { title: 'Second Post', file: 'post1-en.md' },
        fa: { title: 'Ÿæÿ≥ÿ™ ÿØŸàŸÖ', file: 'post1-fa.md' }
      },
      {
        date: '2025-07-01',
        tags: ['bias'],
        en: { title: 'Bias', file: '1-en.md' },
        fa: { title: 'ÿ®ÿß€åÿßÿ≥', file: '1-fa.md' }
      },
      {
        date: '2025-07-31',
        tags: ['ml', 'bias'],
        en: { title: 'Inductive Bias', file: 'inductive-bias-en.md' },
        fa: { title: 'ÿ®ÿß€åÿßÿ≥ ÿßÿ≥ÿ™ŸÇÿ±ÿß€å€å', file: 'inductive-bias-fa.md' }
      }
    ];

    const translations = {
      en: {
        subtitle: `"Little bits of deep stuff I‚Äôm figuring out." Milad Vazan`,
        description: `This is where I share what I‚Äôm learning about machine learning, deep learning, and data ‚Äî from building models and algorithms to database tricks and analytics tips. Quick notes, simple takeaways, just bits of deep tech I‚Äôm into right now.`,
        postsHeading: "Posts",
        back: "‚Üê Back",
        notFound: "Post not found.",
        error: "Error loading post."
      },
      fa: {
        subtitle: `¬´ÿ™⁄©Ÿá‚ÄåŸáÿß€å ⁄©Ÿà⁄Ü€å⁄©€å ÿßÿ≤ ⁄Ü€åÿ≤ÿß€å ÿπŸÖ€åŸÇ€å ⁄©Ÿá ÿØÿßÿ±ŸÖ ⁄©ÿ¥ŸÅÿ¥ŸàŸÜ ŸÖ€å‚Äå⁄©ŸÜŸÖ¬ª ŸÖ€åŸÑÿßÿØ Ÿàÿ≤ÿßŸÜ`,
        description: `ÿß€åŸÜÿ¨ÿß ⁄Ü€åÿ≤Ÿáÿß€å€å ⁄©Ÿá ÿØÿ±ÿ®ÿßÿ±Ÿá €åÿßÿØ⁄Ø€åÿ±€å ŸÖÿßÿ¥€åŸÜÿå €åÿßÿØ⁄Ø€åÿ±€å ÿπŸÖ€åŸÇ Ÿà ÿØÿßÿØŸá €åÿßÿØ ŸÖ€å‚Äå⁄Ø€åÿ±ŸÖ ÿ±Ÿà ŸÖ€å‚ÄåŸÜŸà€åÿ≥ŸÖ ‚Äî ÿßÿ≤ ÿ≥ÿßÿÆÿ™ ŸÖÿØŸÑ‚ÄåŸáÿß Ÿà ÿßŸÑ⁄ØŸàÿ±€åÿ™ŸÖ‚ÄåŸáÿß ÿ™ÿß ÿ™ÿ±ŸÅŸÜÿØŸáÿß€å Ÿæÿß€å⁄ØÿßŸá‚ÄåÿØÿßÿØŸá Ÿà ÿ™ÿ≠ŸÑ€åŸÑ ÿØÿßÿØŸá. €åÿßÿØÿØÿßÿ¥ÿ™‚ÄåŸáÿß€å ⁄©Ÿàÿ™ÿßŸáÿå ÿ≥ÿßÿØŸá Ÿà ŸÅŸàÿ±€å ÿßÿ≤ ⁄Ü€åÿ≤Ÿáÿß€å€å ⁄©Ÿá ÿßŸÑÿßŸÜ ÿØÿ±⁄Ø€åÿ±ÿ¥ŸÖ.`,
        postsHeading: "Ÿæÿ≥ÿ™‚ÄåŸáÿß",
        back: "‚Üê ÿ®ÿßÿ≤⁄Øÿ¥ÿ™",
        notFound: "Ÿæÿ≥ÿ™ Ÿæ€åÿØÿß ŸÜÿ¥ÿØ.",
        error: "ÿÆÿ∑ÿß ÿØÿ± ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å Ÿæÿ≥ÿ™."
      }
    };

    let currentLang = localStorage.getItem('lang') || 'en';

    function applyTranslations() {
      const t = translations[currentLang];
      document.querySelector('.blog-subtitle').innerHTML = t.subtitle;
      document.querySelector('.brand-description').innerHTML = t.description;

      if (currentLang === 'fa') {
        document.body.classList.add('rtl');
      } else {
        document.body.classList.remove('rtl');
      }
    }

    function toggleLanguage() {
      const oldLang = currentLang;
      currentLang = currentLang === 'en' ? 'fa' : 'en';
      localStorage.setItem('lang', currentLang);
      applyTranslations();

      const currentHash = location.hash.slice(1);
      if (!currentHash) {
        // ÿµŸÅÿ≠Ÿá ŸÑ€åÿ≥ÿ™
        router();
      } else {
        // ÿµŸÅÿ≠Ÿá Ÿæÿ≥ÿ™
        const post = posts.find(p => p[oldLang].file === currentHash);
        if (post) {
          // ÿ™ÿ∫€å€åÿ± ÿ¢ÿØÿ±ÿ≥ ÿ®Ÿá ŸÅÿß€åŸÑ ÿ≤ÿ®ÿßŸÜ ÿ¨ÿØ€åÿØ ÿ®ÿ±ÿß€å ŸáŸÖÿßŸÜ Ÿæÿ≥ÿ™
          location.hash = post[currentLang].file;
        } else {
          // ÿß⁄Øÿ± Ÿæÿ≥ÿ™ €åÿßŸÅÿ™ ŸÜÿ¥ÿØÿå ÿ®Ÿá ŸÑ€åÿ≥ÿ™ ÿ®ÿ±⁄Øÿ±ÿØ
          location.hash = '';
        }
      }
      document.querySelector('.lang-toggle').textContent = currentLang === 'en' ? 'FA' : 'EN';
    }

    function renderList() {
      const t = translations[currentLang];
      let html = `<h2>${t.postsHeading}</h2><div class="post-list">`;
      posts.forEach(p => {
        const postData = p[currentLang];
        html += `
          <a href="#${postData.file}">${postData.title}</a>
          <div class="post-meta">
            üóì ${p.date} | ${p.tags.map(tag => `<span class="tag">${tag}</span>`).join(' ')}
          </div>`;
      });
      html += `</div>`;
      content.innerHTML = html;
    }

    function renderPost(filename) {
      const t = translations[currentLang];
      const post = posts.find(p => p[currentLang].file === filename);
      if (!post) {
        content.innerHTML = `<p>${t.notFound}</p><a href="#" id="back-button">${t.back}</a>`;
        return;
      }

      fetch(`posts/${filename}`)
        .then(res => res.text())
        .then(md => {
          content.innerHTML = `
            <a href="#" id="back-button">${t.back}</a>
            <h2>${post[currentLang].title}</h2>
            <div class="post-meta">üóì ${post.date} | ${post.tags.map(tag => `<span class="tag">${tag}</span>`).join(' ')}</div>
            <div>${marked.parse(md)}</div>
          `;
        })
        .catch(() => {
          content.innerHTML = `<p>${t.error}</p><a href="#" id="back-button">${t.back}</a>`;
        });
    }

    function router() {
      const hash = location.hash.slice(1);
      if (hash) {
        renderPost(hash);
      } else {
        renderList();
      }
    }

    function toggleTheme() {
      document.body.classList.toggle('dark');
      const isDark = document.body.classList.contains('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    }

    function loadTheme() {
      const saved = localStorage.getItem('theme');
      if (saved === 'dark') {
        document.body.classList.add('dark');
      }
    }

    function typeTitle(text, elementId, speed = 70) {
      const el = document.getElementById(elementId);
      let i = 0;
      function type() {
        if (i < text.length) {
          el.innerHTML += text.charAt(i);
          i++;
          setTimeout(type, speed);
        }
      }
      type();
    }

    window.addEventListener('hashchange', router);
    window.addEventListener('load', () => {
      loadTheme();
      applyTranslations();
      router();
      typeTitle('üìì DeepBits', 'blog-title');
      document.querySelector('.lang-toggle').textContent = currentLang === 'en' ? 'FA' : 'EN';
    });

    // ÿ®ÿßÿ≤⁄Øÿ¥ÿ™ ÿ®Ÿá ŸÑ€åÿ≥ÿ™ Ÿæÿ≥ÿ™‚ÄåŸáÿß ŸàŸÇÿ™€å ÿ±Ÿà€å ÿØ⁄©ŸÖŸá back ⁄©ŸÑ€å⁄© ŸÖ€å‚Äåÿ¥ŸàÿØ
    document.addEventListener('click', e => {
      if (e.target && e.target.id === 'back-button') {
        e.preventDefault();
        location.hash = '';
      }
    });
  </script>
</body>
</html>
